function [ Z, Fval, exitflag, output ] = brachistochrone_optimal_loop( Z, x, y, v, g, rows, cols, options )

    [ Z, Fval, exitflag, output ] = fsolve(@my_fun, Z, options);
    
    function [ F, dF ] = my_fun( Z )
		F = ...
[10 - Z(12)*Z(22)*cos(Z(13)) - Z(19)*Z(29)*cos(Z(20)) - Z(26)*Z(36)*cos(Z(27)) - Z(33)*Z(43)*cos(Z(34)) - Z(40)*Z(50)*cos(Z(41)) - Z(47)*Z(57)*cos(Z(48)) - Z(54)*Z(64)*cos(Z(55)) - Z(61)*Z(68)*cos(Z(62)) - Z(9)*g*cos(Z(2)) - Z(16)*g*cos(Z(6)) - Z(23)*g*cos(Z(13)) - Z(30)*g*cos(Z(20)) - Z(37)*g*cos(Z(27)) - Z(44)*g*cos(Z(34)) - Z(51)*g*cos(Z(41)) - Z(58)*g*cos(Z(48)) - Z(65)*g*cos(Z(55)) - Z(69)*g*cos(Z(62)) - Z(5)*Z(14)*sin(Z(6)) - Z(12)*Z(21)*sin(Z(13)) - Z(19)*Z(28)*sin(Z(20)) - Z(26)*Z(35)*sin(Z(27)) - Z(33)*Z(42)*sin(Z(34)) - Z(40)*Z(49)*sin(Z(41)) - Z(47)*Z(56)*sin(Z(48)) - Z(54)*Z(63)*sin(Z(55)) - Z(61)*Z(67)*sin(Z(62)) - Z(8)*v(1)*cos(Z(2)) - Z(7)*v(1)*sin(Z(2)) - Z(5)*Z(15)*cos(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Z(1)*Z(9)*g*sin(Z(2)) - Z(1)*Z(7)*v(1)*cos(Z(2)) + Z(1)*Z(8)*v(1)*sin(Z(2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(3) - x(1) - Z(1)*v(1)*sin(Z(2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(4) - y(1) - Z(1)*v(1)*cos(Z(2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Z(5) - v(1) - Z(1)*g*cos(Z(2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Z(1)*Z(5)*Z(15)*sin(Z(6)) - Z(1)*Z(5)*Z(14)*cos(Z(6)) + Z(1)*Z(16)*g*sin(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Z(7) - Z(14);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Z(8) - Z(15);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Z(9) - Z(16) - Z(1)*Z(15)*cos(Z(6)) - Z(1)*Z(14)*sin(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Z(10) - Z(3) - Z(1)*Z(5)*sin(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Z(11) - Z(4) - Z(1)*Z(5)*cos(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Z(12) - Z(5) - Z(1)*g*cos(Z(6));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(12)*Z(22)*sin(Z(13)) - Z(1)*Z(12)*Z(21)*cos(Z(13)) + Z(1)*Z(23)*g*sin(Z(13));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(14) - Z(21);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(15) - Z(22);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(16) - Z(23) - Z(1)*Z(22)*cos(Z(13)) - Z(1)*Z(21)*sin(Z(13));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(17) - Z(10) - Z(1)*Z(12)*sin(Z(13));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(18) - Z(11) - Z(1)*Z(12)*cos(Z(13));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(19) - Z(12) - Z(1)*g*cos(Z(13));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(19)*Z(29)*sin(Z(20)) - Z(1)*Z(19)*Z(28)*cos(Z(20)) + Z(1)*Z(30)*g*sin(Z(20));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(21) - Z(28);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(22) - Z(29);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(23) - Z(30) - Z(1)*Z(29)*cos(Z(20)) - Z(1)*Z(28)*sin(Z(20));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(24) - Z(17) - Z(1)*Z(19)*sin(Z(20));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(25) - Z(18) - Z(1)*Z(19)*cos(Z(20));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(26) - Z(19) - Z(1)*g*cos(Z(20));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(26)*Z(36)*sin(Z(27)) - Z(1)*Z(26)*Z(35)*cos(Z(27)) + Z(1)*Z(37)*g*sin(Z(27));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(28) - Z(35);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(29) - Z(36);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(30) - Z(37) - Z(1)*Z(36)*cos(Z(27)) - Z(1)*Z(35)*sin(Z(27));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(31) - Z(24) - Z(1)*Z(26)*sin(Z(27));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(32) - Z(25) - Z(1)*Z(26)*cos(Z(27));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(33) - Z(26) - Z(1)*g*cos(Z(27));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(33)*Z(43)*sin(Z(34)) - Z(1)*Z(33)*Z(42)*cos(Z(34)) + Z(1)*Z(44)*g*sin(Z(34));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(35) - Z(42);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(36) - Z(43);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(37) - Z(44) - Z(1)*Z(43)*cos(Z(34)) - Z(1)*Z(42)*sin(Z(34));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(38) - Z(31) - Z(1)*Z(33)*sin(Z(34));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(39) - Z(32) - Z(1)*Z(33)*cos(Z(34));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(40) - Z(33) - Z(1)*g*cos(Z(34));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(40)*Z(50)*sin(Z(41)) - Z(1)*Z(40)*Z(49)*cos(Z(41)) + Z(1)*Z(51)*g*sin(Z(41));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(42) - Z(49);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(43) - Z(50);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(44) - Z(51) - Z(1)*Z(50)*cos(Z(41)) - Z(1)*Z(49)*sin(Z(41));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(45) - Z(38) - Z(1)*Z(40)*sin(Z(41));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(46) - Z(39) - Z(1)*Z(40)*cos(Z(41));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(47) - Z(40) - Z(1)*g*cos(Z(41));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(47)*Z(57)*sin(Z(48)) - Z(1)*Z(47)*Z(56)*cos(Z(48)) + Z(1)*Z(58)*g*sin(Z(48));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(49) - Z(56);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(50) - Z(57);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(51) - Z(58) - Z(1)*Z(57)*cos(Z(48)) - Z(1)*Z(56)*sin(Z(48));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(52) - Z(45) - Z(1)*Z(47)*sin(Z(48));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(53) - Z(46) - Z(1)*Z(47)*cos(Z(48));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(54) - Z(47) - Z(1)*g*cos(Z(48));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(54)*Z(64)*sin(Z(55)) - Z(1)*Z(54)*Z(63)*cos(Z(55)) + Z(1)*Z(65)*g*sin(Z(55));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(56) - Z(63);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(57) - Z(64);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(58) - Z(65) - Z(1)*Z(64)*cos(Z(55)) - Z(1)*Z(63)*sin(Z(55));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(59) - Z(52) - Z(1)*Z(54)*sin(Z(55));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(60) - Z(53) - Z(1)*Z(54)*cos(Z(55));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(61) - Z(54) - Z(1)*g*cos(Z(55));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Z(1)*Z(61)*Z(68)*sin(Z(62)) - Z(1)*Z(61)*Z(67)*cos(Z(62)) + Z(1)*Z(69)*g*sin(Z(62));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(63) - Z(67);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(64) - Z(68);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Z(65) - Z(69) - Z(1)*Z(68)*cos(Z(62)) - Z(1)*Z(67)*sin(Z(62));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       x(11) - Z(59) - Z(1)*Z(61)*sin(Z(62));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       y(11) - Z(60) - Z(1)*Z(61)*cos(Z(62));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Z(66) - Z(61) - Z(1)*g*cos(Z(62));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Z(69)];
		
        dF = sparse(rows, cols, [                       Z(9)*g*sin(Z(2)) - Z(7)*v(1)*cos(Z(2)) + Z(8)*v(1)*sin(Z(2));
                                                                     -v(1)*sin(Z(2));
                                                                     -v(1)*cos(Z(2));
                                                                        -g*cos(Z(2));
                     Z(5)*Z(15)*sin(Z(6)) - Z(5)*Z(14)*cos(Z(6)) + Z(16)*g*sin(Z(6));
                                                 - Z(15)*cos(Z(6)) - Z(14)*sin(Z(6));
                                                                     -Z(5)*sin(Z(6));
                                                                     -Z(5)*cos(Z(6));
                                                                        -g*cos(Z(6));
                Z(12)*Z(22)*sin(Z(13)) - Z(12)*Z(21)*cos(Z(13)) + Z(23)*g*sin(Z(13));
                                               - Z(22)*cos(Z(13)) - Z(21)*sin(Z(13));
                                                                   -Z(12)*sin(Z(13));
                                                                   -Z(12)*cos(Z(13));
                                                                       -g*cos(Z(13));
                Z(19)*Z(29)*sin(Z(20)) - Z(19)*Z(28)*cos(Z(20)) + Z(30)*g*sin(Z(20));
                                               - Z(29)*cos(Z(20)) - Z(28)*sin(Z(20));
                                                                   -Z(19)*sin(Z(20));
                                                                   -Z(19)*cos(Z(20));
                                                                       -g*cos(Z(20));
                Z(26)*Z(36)*sin(Z(27)) - Z(26)*Z(35)*cos(Z(27)) + Z(37)*g*sin(Z(27));
                                               - Z(36)*cos(Z(27)) - Z(35)*sin(Z(27));
                                                                   -Z(26)*sin(Z(27));
                                                                   -Z(26)*cos(Z(27));
                                                                       -g*cos(Z(27));
                Z(33)*Z(43)*sin(Z(34)) - Z(33)*Z(42)*cos(Z(34)) + Z(44)*g*sin(Z(34));
                                               - Z(43)*cos(Z(34)) - Z(42)*sin(Z(34));
                                                                   -Z(33)*sin(Z(34));
                                                                   -Z(33)*cos(Z(34));
                                                                       -g*cos(Z(34));
                Z(40)*Z(50)*sin(Z(41)) - Z(40)*Z(49)*cos(Z(41)) + Z(51)*g*sin(Z(41));
                                               - Z(50)*cos(Z(41)) - Z(49)*sin(Z(41));
                                                                   -Z(40)*sin(Z(41));
                                                                   -Z(40)*cos(Z(41));
                                                                       -g*cos(Z(41));
                Z(47)*Z(57)*sin(Z(48)) - Z(47)*Z(56)*cos(Z(48)) + Z(58)*g*sin(Z(48));
                                               - Z(57)*cos(Z(48)) - Z(56)*sin(Z(48));
                                                                   -Z(47)*sin(Z(48));
                                                                   -Z(47)*cos(Z(48));
                                                                       -g*cos(Z(48));
                Z(54)*Z(64)*sin(Z(55)) - Z(54)*Z(63)*cos(Z(55)) + Z(65)*g*sin(Z(55));
                                               - Z(64)*cos(Z(55)) - Z(63)*sin(Z(55));
                                                                   -Z(54)*sin(Z(55));
                                                                   -Z(54)*cos(Z(55));
                                                                       -g*cos(Z(55));
                Z(61)*Z(68)*sin(Z(62)) - Z(61)*Z(67)*cos(Z(62)) + Z(69)*g*sin(Z(62));
                                               - Z(68)*cos(Z(62)) - Z(67)*sin(Z(62));
                                                                   -Z(61)*sin(Z(62));
                                                                   -Z(61)*cos(Z(62));
                                                                       -g*cos(Z(62));
                        Z(9)*g*sin(Z(2)) - Z(7)*v(1)*cos(Z(2)) + Z(8)*v(1)*sin(Z(2));
         Z(1)*Z(9)*g*cos(Z(2)) + Z(1)*Z(8)*v(1)*cos(Z(2)) + Z(1)*Z(7)*v(1)*sin(Z(2));
                                                                -Z(1)*v(1)*cos(Z(2));
                                                                 Z(1)*v(1)*sin(Z(2));
                                                                    Z(1)*g*sin(Z(2));
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                                 - Z(15)*cos(Z(6)) - Z(14)*sin(Z(6));
                                                                                   1;
                                         Z(1)*Z(15)*sin(Z(6)) - Z(1)*Z(14)*cos(Z(6));
                                                                     -Z(1)*sin(Z(6));
                                                                     -Z(1)*cos(Z(6));
                                                                                  -1;
                     Z(5)*Z(15)*sin(Z(6)) - Z(5)*Z(14)*cos(Z(6)) + Z(16)*g*sin(Z(6));
      Z(1)*Z(5)*Z(15)*cos(Z(6)) + Z(1)*Z(16)*g*cos(Z(6)) + Z(1)*Z(5)*Z(14)*sin(Z(6));
                                         Z(1)*Z(15)*sin(Z(6)) - Z(1)*Z(14)*cos(Z(6));
                                                                -Z(1)*Z(5)*cos(Z(6));
                                                                 Z(1)*Z(5)*sin(Z(6));
                                                                    Z(1)*g*sin(Z(6));
                                                                     -v(1)*sin(Z(2));
                                                                -Z(1)*v(1)*cos(Z(2));
                                                                                   1;
                                                                     -v(1)*cos(Z(2));
                                                                 Z(1)*v(1)*sin(Z(2));
                                                                                   1;
                                                                        -g*cos(Z(2));
                                                                    Z(1)*g*sin(Z(2));
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(22)*cos(Z(13)) - Z(21)*sin(Z(13));
                                                                                   1;
                                       Z(1)*Z(22)*sin(Z(13)) - Z(1)*Z(21)*cos(Z(13));
                                                                    -Z(1)*sin(Z(13));
                                                                    -Z(1)*cos(Z(13));
                                                                                  -1;
                Z(12)*Z(22)*sin(Z(13)) - Z(12)*Z(21)*cos(Z(13)) + Z(23)*g*sin(Z(13));
 Z(1)*Z(12)*Z(22)*cos(Z(13)) + Z(1)*Z(23)*g*cos(Z(13)) + Z(1)*Z(12)*Z(21)*sin(Z(13));
                                       Z(1)*Z(22)*sin(Z(13)) - Z(1)*Z(21)*cos(Z(13));
                                                              -Z(1)*Z(12)*cos(Z(13));
                                                               Z(1)*Z(12)*sin(Z(13));
                                                                   Z(1)*g*sin(Z(13));
                                                                     -Z(5)*sin(Z(6));
                                                                -Z(1)*Z(5)*cos(Z(6));
                                                                                  -1;
                                                                     -Z(1)*sin(Z(6));
                                                                                   1;
                                                                     -Z(5)*cos(Z(6));
                                                                 Z(1)*Z(5)*sin(Z(6));
                                                                                  -1;
                                                                     -Z(1)*cos(Z(6));
                                                                                   1;
                                                                        -g*cos(Z(6));
                                                                    Z(1)*g*sin(Z(6));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(29)*cos(Z(20)) - Z(28)*sin(Z(20));
                                                                                   1;
                                       Z(1)*Z(29)*sin(Z(20)) - Z(1)*Z(28)*cos(Z(20));
                                                                    -Z(1)*sin(Z(20));
                                                                    -Z(1)*cos(Z(20));
                                                                                  -1;
                Z(19)*Z(29)*sin(Z(20)) - Z(19)*Z(28)*cos(Z(20)) + Z(30)*g*sin(Z(20));
 Z(1)*Z(19)*Z(29)*cos(Z(20)) + Z(1)*Z(30)*g*cos(Z(20)) + Z(1)*Z(19)*Z(28)*sin(Z(20));
                                       Z(1)*Z(29)*sin(Z(20)) - Z(1)*Z(28)*cos(Z(20));
                                                              -Z(1)*Z(19)*cos(Z(20));
                                                               Z(1)*Z(19)*sin(Z(20));
                                                                   Z(1)*g*sin(Z(20));
                                                                   -Z(12)*sin(Z(13));
                                                              -Z(1)*Z(12)*cos(Z(13));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(13));
                                                                                   1;
                                                                   -Z(12)*cos(Z(13));
                                                               Z(1)*Z(12)*sin(Z(13));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(13));
                                                                                   1;
                                                                       -g*cos(Z(13));
                                                                   Z(1)*g*sin(Z(13));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(36)*cos(Z(27)) - Z(35)*sin(Z(27));
                                                                                   1;
                                       Z(1)*Z(36)*sin(Z(27)) - Z(1)*Z(35)*cos(Z(27));
                                                                    -Z(1)*sin(Z(27));
                                                                    -Z(1)*cos(Z(27));
                                                                                  -1;
                Z(26)*Z(36)*sin(Z(27)) - Z(26)*Z(35)*cos(Z(27)) + Z(37)*g*sin(Z(27));
 Z(1)*Z(26)*Z(36)*cos(Z(27)) + Z(1)*Z(37)*g*cos(Z(27)) + Z(1)*Z(26)*Z(35)*sin(Z(27));
                                       Z(1)*Z(36)*sin(Z(27)) - Z(1)*Z(35)*cos(Z(27));
                                                              -Z(1)*Z(26)*cos(Z(27));
                                                               Z(1)*Z(26)*sin(Z(27));
                                                                   Z(1)*g*sin(Z(27));
                                                                   -Z(19)*sin(Z(20));
                                                              -Z(1)*Z(19)*cos(Z(20));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(20));
                                                                                   1;
                                                                   -Z(19)*cos(Z(20));
                                                               Z(1)*Z(19)*sin(Z(20));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(20));
                                                                                   1;
                                                                       -g*cos(Z(20));
                                                                   Z(1)*g*sin(Z(20));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(43)*cos(Z(34)) - Z(42)*sin(Z(34));
                                                                                   1;
                                       Z(1)*Z(43)*sin(Z(34)) - Z(1)*Z(42)*cos(Z(34));
                                                                    -Z(1)*sin(Z(34));
                                                                    -Z(1)*cos(Z(34));
                                                                                  -1;
                Z(33)*Z(43)*sin(Z(34)) - Z(33)*Z(42)*cos(Z(34)) + Z(44)*g*sin(Z(34));
 Z(1)*Z(33)*Z(43)*cos(Z(34)) + Z(1)*Z(44)*g*cos(Z(34)) + Z(1)*Z(33)*Z(42)*sin(Z(34));
                                       Z(1)*Z(43)*sin(Z(34)) - Z(1)*Z(42)*cos(Z(34));
                                                              -Z(1)*Z(33)*cos(Z(34));
                                                               Z(1)*Z(33)*sin(Z(34));
                                                                   Z(1)*g*sin(Z(34));
                                                                   -Z(26)*sin(Z(27));
                                                              -Z(1)*Z(26)*cos(Z(27));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(27));
                                                                                   1;
                                                                   -Z(26)*cos(Z(27));
                                                               Z(1)*Z(26)*sin(Z(27));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(27));
                                                                                   1;
                                                                       -g*cos(Z(27));
                                                                   Z(1)*g*sin(Z(27));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(50)*cos(Z(41)) - Z(49)*sin(Z(41));
                                                                                   1;
                                       Z(1)*Z(50)*sin(Z(41)) - Z(1)*Z(49)*cos(Z(41));
                                                                    -Z(1)*sin(Z(41));
                                                                    -Z(1)*cos(Z(41));
                                                                                  -1;
                Z(40)*Z(50)*sin(Z(41)) - Z(40)*Z(49)*cos(Z(41)) + Z(51)*g*sin(Z(41));
 Z(1)*Z(40)*Z(50)*cos(Z(41)) + Z(1)*Z(51)*g*cos(Z(41)) + Z(1)*Z(40)*Z(49)*sin(Z(41));
                                       Z(1)*Z(50)*sin(Z(41)) - Z(1)*Z(49)*cos(Z(41));
                                                              -Z(1)*Z(40)*cos(Z(41));
                                                               Z(1)*Z(40)*sin(Z(41));
                                                                   Z(1)*g*sin(Z(41));
                                                                   -Z(33)*sin(Z(34));
                                                              -Z(1)*Z(33)*cos(Z(34));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(34));
                                                                                   1;
                                                                   -Z(33)*cos(Z(34));
                                                               Z(1)*Z(33)*sin(Z(34));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(34));
                                                                                   1;
                                                                       -g*cos(Z(34));
                                                                   Z(1)*g*sin(Z(34));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(57)*cos(Z(48)) - Z(56)*sin(Z(48));
                                                                                   1;
                                       Z(1)*Z(57)*sin(Z(48)) - Z(1)*Z(56)*cos(Z(48));
                                                                    -Z(1)*sin(Z(48));
                                                                    -Z(1)*cos(Z(48));
                                                                                  -1;
                Z(47)*Z(57)*sin(Z(48)) - Z(47)*Z(56)*cos(Z(48)) + Z(58)*g*sin(Z(48));
 Z(1)*Z(47)*Z(57)*cos(Z(48)) + Z(1)*Z(58)*g*cos(Z(48)) + Z(1)*Z(47)*Z(56)*sin(Z(48));
                                       Z(1)*Z(57)*sin(Z(48)) - Z(1)*Z(56)*cos(Z(48));
                                                              -Z(1)*Z(47)*cos(Z(48));
                                                               Z(1)*Z(47)*sin(Z(48));
                                                                   Z(1)*g*sin(Z(48));
                                                                   -Z(40)*sin(Z(41));
                                                              -Z(1)*Z(40)*cos(Z(41));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(41));
                                                                                   1;
                                                                   -Z(40)*cos(Z(41));
                                                               Z(1)*Z(40)*sin(Z(41));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(41));
                                                                                   1;
                                                                       -g*cos(Z(41));
                                                                   Z(1)*g*sin(Z(41));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(64)*cos(Z(55)) - Z(63)*sin(Z(55));
                                                                                   1;
                                       Z(1)*Z(64)*sin(Z(55)) - Z(1)*Z(63)*cos(Z(55));
                                                                    -Z(1)*sin(Z(55));
                                                                    -Z(1)*cos(Z(55));
                                                                                  -1;
                Z(54)*Z(64)*sin(Z(55)) - Z(54)*Z(63)*cos(Z(55)) + Z(65)*g*sin(Z(55));
 Z(1)*Z(54)*Z(64)*cos(Z(55)) + Z(1)*Z(65)*g*cos(Z(55)) + Z(1)*Z(54)*Z(63)*sin(Z(55));
                                       Z(1)*Z(64)*sin(Z(55)) - Z(1)*Z(63)*cos(Z(55));
                                                              -Z(1)*Z(54)*cos(Z(55));
                                                               Z(1)*Z(54)*sin(Z(55));
                                                                   Z(1)*g*sin(Z(55));
                                                                   -Z(47)*sin(Z(48));
                                                              -Z(1)*Z(47)*cos(Z(48));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(48));
                                                                                   1;
                                                                   -Z(47)*cos(Z(48));
                                                               Z(1)*Z(47)*sin(Z(48));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(48));
                                                                                   1;
                                                                       -g*cos(Z(48));
                                                                   Z(1)*g*sin(Z(48));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                                  -1;
                                                                                   1;
                                                                                  -1;
                                               - Z(68)*cos(Z(62)) - Z(67)*sin(Z(62));
                                                                                   1;
                                       Z(1)*Z(68)*sin(Z(62)) - Z(1)*Z(67)*cos(Z(62));
                                                                    -Z(1)*sin(Z(62));
                                                                    -Z(1)*cos(Z(62));
                                                                                  -1;
                Z(61)*Z(68)*sin(Z(62)) - Z(61)*Z(67)*cos(Z(62)) + Z(69)*g*sin(Z(62));
 Z(1)*Z(61)*Z(68)*cos(Z(62)) + Z(1)*Z(69)*g*cos(Z(62)) + Z(1)*Z(61)*Z(67)*sin(Z(62));
                                       Z(1)*Z(68)*sin(Z(62)) - Z(1)*Z(67)*cos(Z(62));
                                                              -Z(1)*Z(61)*cos(Z(62));
                                                               Z(1)*Z(61)*sin(Z(62));
                                                                   Z(1)*g*sin(Z(62));
                                                                   -Z(54)*sin(Z(55));
                                                              -Z(1)*Z(54)*cos(Z(55));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(55));
                                                                                   1;
                                                                   -Z(54)*cos(Z(55));
                                                               Z(1)*Z(54)*sin(Z(55));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(55));
                                                                                   1;
                                                                       -g*cos(Z(55));
                                                                   Z(1)*g*sin(Z(55));
                                                                                  -1;
                                                                                   1;
                                                                                   1;
                                                                   -Z(61)*sin(Z(62));
                                                              -Z(1)*Z(61)*cos(Z(62));
                                                                                  -1;
                                                                    -Z(1)*sin(Z(62));
                                                                   -Z(61)*cos(Z(62));
                                                               Z(1)*Z(61)*sin(Z(62));
                                                                                  -1;
                                                                    -Z(1)*cos(Z(62));
                                                                       -g*cos(Z(62));
                                                                   Z(1)*g*sin(Z(62));
                                                                                  -1;
                                                                                   1]);

		J = 10*Z(1) - Z(16)*(Z(5) - Z(12) + Z(1)*g*cos(Z(6))) - Z(23)*(Z(12) - Z(19) + Z(1)*g*cos(Z(13))) - Z(30)*(Z(19) - Z(26) + Z(1)*g*cos(Z(20))) - Z(37)*(Z(26) - Z(33) + Z(1)*g*cos(Z(27))) - Z(44)*(Z(33) - Z(40) + Z(1)*g*cos(Z(34))) - Z(51)*(Z(40) - Z(47) + Z(1)*g*cos(Z(41))) - Z(58)*(Z(47) - Z(54) + Z(1)*g*cos(Z(48))) - Z(65)*(Z(54) - Z(61) + Z(1)*g*cos(Z(55))) - Z(69)*(Z(61) - Z(66) + Z(1)*g*cos(Z(62))) - Z(14)*(Z(3) - Z(10) + Z(1)*Z(5)*sin(Z(6))) - Z(21)*(Z(10) - Z(17) + Z(1)*Z(12)*sin(Z(13))) - Z(28)*(Z(17) - Z(24) + Z(1)*Z(19)*sin(Z(20))) - Z(35)*(Z(24) - Z(31) + Z(1)*Z(26)*sin(Z(27))) - Z(42)*(Z(31) - Z(38) + Z(1)*Z(33)*sin(Z(34))) - Z(49)*(Z(38) - Z(45) + Z(1)*Z(40)*sin(Z(41))) - Z(56)*(Z(45) - Z(52) + Z(1)*Z(47)*sin(Z(48))) - Z(63)*(Z(52) - Z(59) + Z(1)*Z(54)*sin(Z(55))) - Z(68)*(Z(60) - y(11) + Z(1)*Z(61)*cos(Z(62))) - Z(9)*(v(1) - Z(5) + Z(1)*g*cos(Z(2))) - Z(67)*(Z(59) - x(11) + Z(1)*Z(61)*sin(Z(62))) - Z(8)*(y(1) - Z(4) + Z(1)*v(1)*cos(Z(2))) - Z(7)*(x(1) - Z(3) + Z(1)*v(1)*sin(Z(2))) - Z(15)*(Z(4) - Z(11) + Z(1)*Z(5)*cos(Z(6))) - Z(22)*(Z(11) - Z(18) + Z(1)*Z(12)*cos(Z(13))) - Z(29)*(Z(18) - Z(25) + Z(1)*Z(19)*cos(Z(20))) - Z(36)*(Z(25) - Z(32) + Z(1)*Z(26)*cos(Z(27))) - Z(43)*(Z(32) - Z(39) + Z(1)*Z(33)*cos(Z(34))) - Z(50)*(Z(39) - Z(46) + Z(1)*Z(40)*cos(Z(41))) - Z(57)*(Z(46) - Z(53) + Z(1)*Z(47)*cos(Z(48))) - Z(64)*(Z(53) - Z(60) + Z(1)*Z(54)*cos(Z(55)));
		display(['Objective function value:', num2str(J)])
    end

end

